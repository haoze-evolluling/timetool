# Windows 系统时间修改工具

一个基于 PyQt5 的 Windows 系统时间快速修改工具，专为需要快速调整系统时间的用户设计。该工具提供直观的图形界面，支持预设时间调整、NTP 网络时间同步和操作撤销功能，适用于软件测试、开发调试等场景。

## 功能特性

- 🕒 实时显示当前系统时间（每秒自动更新）
- ⚡ 预设时间调整按钮（±3天、±7天快速调整）
- 🌐 多服务器 NTP 时间同步（支持阿里云等8个服务器）
- 🔒 智能 UAC 管理员权限请求
- 📝 详细操作日志记录（含时间戳和结果）
- ↩️ 时间更改撤销功能（防止误操作）
- ✅ 危险操作确认机制

## 系统要求

- 操作系统：Windows 10/11（32位/64位）
- 运行环境：Python 3.7+ 或直接使用预编译可执行文件
- 权限要求：管理员权限（修改系统时间必需）
- 网络环境：NTP 同步需要互联网连接（端口123）

## 安装与运行

### 方法一：从源代码运行

1. **安装 Python 3.7+**
   从 [python.org](https://python.org) 下载并安装 Python，确保添加到 PATH

2. **获取源代码**
   ```bash
   git clone <repository-url>
   cd timetool
   ```

3. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

4. **运行应用程序**
   ```bash
   python main.py
   ```

### 方法二：使用预编译可执行文件

1. 从发布页面下载 `TimeToolGUI.exe`
2. 双击运行（程序会自动请求管理员权限）

### 方法三：自行构建可执行文件

1. **安装构建依赖**（同方法一第3步）

2. **运行构建脚本**
   ```bash
   # 使用批处理脚本
   build.bat
   
   # 或直接运行 Python 脚本
   python build.py
   ```

3. 构建结果位于 `dist/TimeToolGUI.exe`

## 使用指南

### 基本操作流程

1. 启动程序（自动请求管理员权限）
2. 查看顶部显示的当前系统时间
3. 选择操作方式：
   - 点击快速调整按钮（±3天/±7天）
   - 点击「同步阿里云时间服务器」按钮
4. 在确认对话框中验证更改信息
5. 查看操作结果（日志区域和状态栏）
6. 如需恢复，点击「撤销上次时间更改」按钮

### NTP 同步说明

程序使用阿里云 NTP 服务器池进行时间同步，包括：
- ntp.aliyun.com、ntp1-7.aliyun.com
- 同步过程：配置服务器 → 重启时间服务 → 执行同步
- 通常需要10-30秒完成

## 项目结构

```
timetool/
├── main.py                 # 主程序入口
├── main_window.py          # PyQt5 主窗口界面
├── time_manager.py         # Windows 时间管理核心
├── ntp_client.py           # NTP 客户端实现
├── error_handler.py        # 错误处理和权限管理
├── build.py                # 构建脚本
├── build.bat               # Windows 构建批处理
├── requirements.txt        # Python 依赖包
├── README.md               # 项目说明
└── doc/                    # 文档文件夹
```

## 技术栈

- **核心框架**：Python 3.7+、PyQt5
- **系统交互**：pywin32、ctypes、Windows API
- **网络时间**：ntplib、NTP 协议
- **打包工具**：PyInstaller
- **日志系统**：Python logging 模块

## 故障排除

### 常见问题与解决方法

1. **权限被拒绝**
   - 确保以管理员身份运行
   - 检查 UAC 设置，不要禁用管理员批准模式

2. **NTP 同步失败**
   - 检查网络连接和防火墙设置（允许端口123）
   - 尝试更换其他 NTP 服务器

3. **程序无法启动**
   - 验证 Python 安装和 PATH 配置
   - 重新安装依赖：`pip install -r requirements.txt`

4. **界面显示异常**
   - 更新显卡驱动
   - 尝试调整系统显示缩放比例

## 注意事项

- **数据安全**：修改系统时间前建议备份重要数据
- **系统影响**：时间更改可能影响文件时间戳和日志记录
- **环境建议**：优先在测试环境中使用
- **恢复方法**：使用 NTP 同步可恢复准确系统时间

## 许可证

MIT License
