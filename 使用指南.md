# Windows 系统时间修改工具 - 使用指南

## 概述

这是一个基于 PyQt5 的 Windows 系统时间快速修改工具，专为需要快速调整系统时间的用户设计。该工具提供了直观的图形界面，支持预设时间调整、NTP 网络时间同步和操作撤销功能。

## 主要功能

### 🕒 实时时间显示
- 在主界面顶部显示当前系统时间
- 每秒自动更新，确保显示准确

### ⚡ 快速时间调整
- **向后 7 天**：将系统时间向前调整 7 天
- **向后 3 天**：将系统时间向前调整 3 天  
- **向前 3 天**：将系统时间向后调整 3 天
- **向前 7 天**：将系统时间向后调整 7 天

### 🌐 NTP 网络时间同步
- 从多个可靠的 NTP 服务器获取准确时间
- 自动选择响应最快的服务器
- 支持的 NTP 服务器包括：
  - time.windows.com
  - pool.ntp.org
  - time.nist.gov
  - time.google.com
  - ntp.aliyun.com
  - cn.pool.ntp.org

### ↩️ 撤销功能
- 记录最近一次的时间更改
- 一键恢复到修改前的时间
- 防止误操作造成的问题

### 📝 操作日志
- 详细记录所有操作和结果
- 显示操作时间戳
- 便于追踪和调试

## 安装和运行

### 方法一：从源代码运行

1. **安装 Python 3.7+**
   - 从 [python.org](https://python.org) 下载并安装 Python
   - 确保将 Python 添加到 PATH 环境变量

2. **下载源代码**
   ```bash
   # 如果使用 git
   git clone <repository-url>
   cd timetool
   
   # 或者直接下载并解压源代码包
   ```

3. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

4. **运行应用程序**
   ```bash
   python main.py
   ```

### 方法二：使用预编译的可执行文件

1. **下载可执行文件**
   - 从发布页面下载 `TimeToolGUI.exe`

2. **运行程序**
   - 双击 `TimeToolGUI.exe` 启动程序
   - 程序会自动请求管理员权限

### 方法三：构建可执行文件

1. **安装构建依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行构建脚本**
   ```bash
   # Windows 批处理脚本
   build.bat
   
   # 或者直接运行 Python 脚本
   python build.py
   ```

3. **查找生成的文件**
   - 可执行文件位于 `dist/TimeToolGUI.exe`
   - 安装脚本位于 `dist/install.bat`
   - 卸载脚本位于 `dist/uninstall.bat`

## 使用说明

### 首次启动

1. **权限请求**
   - 程序启动时会检查管理员权限
   - 如果没有权限，会显示 UAC 提示请求权限
   - 必须授予管理员权限才能修改系统时间

2. **界面介绍**
   - 顶部显示当前系统时间
   - 中间是快速调整按钮
   - 下方是 NTP 同步和撤销按钮
   - 底部是操作日志区域

### 快速时间调整

1. **选择调整方式**
   - 点击相应的调整按钮（±3天、±7天）

2. **确认操作**
   - 系统会显示确认对话框
   - 显示当前时间和调整后的时间
   - 点击"是"确认，"否"取消

3. **查看结果**
   - 操作结果会显示在日志区域
   - 状态栏会显示操作状态

### NTP 时间同步

1. **启动同步**
   - 点击"同步网络时间 (NTP)"按钮

2. **确认同步**
   - 阅读确认对话框中的说明
   - 点击"是"开始同步

3. **等待完成**
   - 进度条显示同步进度
   - 同步完成后会显示结果

### 撤销操作

1. **检查可用性**
   - 撤销按钮只在有可撤销操作时启用

2. **执行撤销**
   - 点击"撤销上次时间更改"按钮
   - 确认撤销操作

## 注意事项

### ⚠️ 重要警告

1. **管理员权限**
   - 修改系统时间需要管理员权限
   - 请确保以管理员身份运行程序

2. **系统影响**
   - 修改系统时间可能影响其他程序
   - 可能影响文件时间戳和系统日志
   - 建议在测试环境中使用

3. **网络连接**
   - NTP 同步需要网络连接
   - 防火墙可能阻止 NTP 请求（端口 123）

### 💡 使用建议

1. **测试环境**
   - 建议先在测试环境中验证功能
   - 避免在生产环境中随意修改时间

2. **备份重要数据**
   - 时间修改前建议备份重要数据
   - 特别是依赖时间戳的数据

3. **使用 NTP 同步**
   - 完成测试后使用 NTP 同步恢复准确时间
   - 定期同步以保持时间准确性

## 故障排除

### 常见问题

1. **程序无法启动**
   - 检查 Python 是否正确安装
   - 确认所有依赖包已安装
   - 查看错误日志了解具体问题

2. **权限被拒绝**
   - 确保以管理员身份运行
   - 检查 UAC 设置
   - 尝试右键"以管理员身份运行"

3. **NTP 同步失败**
   - 检查网络连接
   - 确认防火墙设置
   - 尝试不同的 NTP 服务器

4. **时间修改失败**
   - 确认管理员权限
   - 检查系统时间服务状态
   - 查看详细错误信息

### 日志文件

- 程序会生成 `time_tool.log` 日志文件
- 包含详细的操作记录和错误信息
- 可用于问题诊断和调试

## 技术支持

如果遇到问题或需要帮助：

1. 查看操作日志了解错误详情
2. 检查 `time_tool.log` 文件
3. 确认系统环境和权限设置
4. 参考本文档的故障排除部分

## 版本信息

- **当前版本**：1.0
- **支持系统**：Windows 10/11
- **Python 版本**：3.7+
- **主要依赖**：PyQt5, pywin32, ntplib

---

**免责声明**：本工具仅供学习和测试使用。修改系统时间可能对系统和应用程序产生影响，请谨慎使用并自行承担风险。
